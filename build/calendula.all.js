var Calendula=function(t,e){"use strict";function i(t){return(t%4||!(t%100))&&t%400?!1:!0}var n="calendula",a=0,o=11,s=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},r=function(t){t=s({},t||{});var e=(new Date,this._prepareYears(t.years)),i=this;this._data=s(t,{autoclose:"undefined"==typeof t.autoclose?!0:t.autoclose,closeAfterSelection:"undefined"==typeof t.closeAfterSelection?!0:t.closeAfterSelection,locale:t.locale||r._defaultLocale,theme:t.theme||"default",_startYear:e.start,_endYear:e.end}),this._domEvent=new v,this.val(this._data.value);var n=this.setting("button");n&&this._domEvent.on(n,"click",function(){i.toggle()},"init")};r.version="0.9.0",s(r.prototype,{isOpened:function(){return this._isOpened},open:function(){var t=this;return this._init(),this._ignoreDocumentClick=!0,this.isOpened()||(this._timeout.set(function(){d(t._container,l("opened")),t._update(),t._monthSelector(t._currentDate.month,!1),t._yearSelector(t._currentDate.year,!1),t._openedEvents()},1,"open"),this._isOpened=!0,this.trigger("open")),this},close:function(){return this._init(),this.isOpened()&&(this._ignoreDocumentClick=!1,this._timeout.clearAll("open"),this._update(),this._delOpenedEvents(),_(this._container,l("opened")),this._isOpened=!1,this.trigger("close")),this},toggle:function(){return this.isOpened()?this.close():this.open(),this},val:function(t){var e;return arguments.length?void(t?("string"==typeof t?e=Date.parse(t):"object"==typeof t?e=t instanceof Date?t:new Date(t.year,t.month,t.day,12,0,0,0):"number"==typeof number&&(e=new Date(t)),this._val={day:e.getDate(),month:e.getMonth(),year:e.getFullYear()},this._currentDate=s({},this._val)):(this._val={},this._currentDate=this._current())):this._val},setting:function(t,e){if(1===arguments.length)return this._data[t];var i=this._data[t],n=this._container;return this._data[t]=e,n&&("theme"===t&&(_(n,l("theme",i)),d(n,l("theme",e))),"locale"===t&&this._rebuild()),this},destroy:function(){this._isInited&&(this.close(),this._timeout.clearAll(),this._eventBuf=[],this._domEvent.offAll(),e.body.removeChild(this._container),["_container","_data","_domEvent","_ignoreDocumentClick","_isInited","_isOpened","_timeout"].forEach(function(t){delete this[t]},this))},_init:function(){if(!this._isInited){this._isInited=!0,this._timeout=new y,this._templates.parent=this;var t=e.createElement("div");this._container=t,d(t,n),d(t,l("theme",this._data.theme)),this._rebuild(),e.body.appendChild(t)}},_current:function(){var t=new Date;return{day:t.getDate(),month:t.getMonth(),year:t.getFullYear()}},_update:function(){this._init();var t,e=this.setting("button");e&&(t=this._offset(e),t.top+=e.offsetHeight,this._position(this._container,t))},_resize:function(){this._update()},_rebuild:function(){this._container.innerHTML=this.template("main")},_rebuildDays:function(){this._elem("days-container").innerHTML=this._templates.prepare(this._templates.days(this._currentDate.year)),this._monthSelector(this._currentDate.month,!1)},_openedEvents:function(){var i=this;this._ignoreDocumentClick=!1,this._domEvent.on(e,"click",function(t){!t.button&&i.setting("autoclose")&&(i._ignoreDocumentClick?i._ignoreDocumentClick=!1:i.close())},"open"),this._domEvent.on(t,"resize",function(){i._resize()},"open"),this._domEvent.on(e,"keypress",function(t){27===t.keyCode&&i.close()},"open"),this._domEvent.on(this._container,"click",function(t){t.button||(i._ignoreDocumentClick=!0)},"open");var n=this._elem("days"),a=this._elem("months"),o=this._elem("years");this._onwheelmonths=function(t){var e=0;t.deltaY>0?e=1:t.deltaY<0&&(e=-1),e&&(i._monthSelector(i._currentDate.month+e,!0),t.preventDefault())},this._onwheelyears=function(t){var e=0;t.deltaY>0?e=1:t.deltaY<0&&(e=-1),e&&(i._yearSelector(i._currentDate.year+e,!0),t.preventDefault())},this._domEvent.onWheel(n,this._onwheelmonths,"open"),this._domEvent.onWheel(a,this._onwheelmonths,"open"),this._domEvent.onWheel(o,this._onwheelyears,"open"),this._domEvent.on(a,"click",function(t){t.button||m(t.target,h("month"))&&i._monthSelector(+u(t.target,"month"),!0)},"open"),this._domEvent.on(o,"click",function(t){if(!t.button){var e=u(t.target,"year");e&&i._yearSelector(+e,!0)}},"open"),this._domEvent.on(n,"click",function(t){if(!t.button){var e=h("day","selected"),a=i._currentDate,o=t.target,s=u(o,"day"),r=u(o,"month");if(s&&!m(o,e)){a.day=+s,a.month=+r;var l=n.querySelector("."+e);l&&_(l,e),d(o,e),i.trigger("select",{day:a.day,month:a.month,year:a.year}),i.setting("closeAfterSelection")&&i.close()}}},"open")},_monthSelector:function(t,e){a>t?t=a:t>o&&(t=o),this._currentDate.month=t;var i,n=this._elem("months"),s=this._elem("month").offsetHeight,r=this._elemAll("days-month"),l=this._elem("month-selector"),c=this._elem("days-container"),u=this._elem("days"),f=h("days","noanim"),m=h("months","noanim");e||(d(u,f),d(n,m));var y=Math.floor(this._currentDate.month*s-s/2);0>=y&&(y=1),y+l.offsetHeight>=n.offsetHeight&&(y=n.offsetHeight-l.offsetHeight-1),this._top(l,y),i=-Math.floor(r[t].offsetTop-u.offsetHeight/2+r[t].offsetHeight/2),i>0&&(i=0);var p=u.offsetHeight-c.offsetHeight;p>i&&(i=p),this._top(c,i),this._colorizeMonths(t),e||this._timeout.set(function(){_(u,f),_(n,m)},0,"anim")},_yearSelector:function(t,e){var i=this._data,n=i._startYear,a=i._endYear,o=this._currentDate.year;n>t?t=n:t>a&&(t=a),this._currentDate.year=t;var s=this._elem("years"),r=this._elem("years-container"),l=this._elem("year").offsetHeight,c=this._elem("year-selector"),n=this._data._startYear,a=this._data._endYear,u=h("years","noanim");e||d(s,u);var f=Math.floor((this._currentDate.year-n)*l),m=-Math.floor((this._currentDate.year-n)*l-s.offsetHeight/2);m>0&&(m=0),m<s.offsetHeight-r.offsetHeight&&(m=s.offsetHeight-r.offsetHeight);var y=0;s.offsetHeight>=r.offsetHeight&&((a-n+1)%2&&(y=l),m=Math.floor((s.offsetHeight-r.offsetHeight-y)/2)),t!==o&&this._rebuildDays(t),this._top(c,f),this._top(r,m),this._colorizeYears(t),e||this._timeout.set(function(){_(s,u)},0,"anim")},_colorizeMonths:function(t){for(var e=this._elemAll("month"),i=5,n=0;i>n;n++)for(var s=this._elemAll("month","color",n),r=0,l=s.length;l>r;r++)_(s[r],h("month","color",n));var c=h("month","color","0");d(e[t],c),t-1>=a&&d(e[t-1],c),o>=t+1&&d(e[t+1],c);var u=1;for(n=t-2;n>=a&&i>u;n--,u++)d(e[n],h("month","color",u));for(u=1,n=t+2;o>=n&&i>u;n++,u++)d(e[n],h("month","color",u))},_colorizeYears:function(t){for(var e=this._elemAll("year"),i=this._data._startYear,n=5,a=0;n>a;a++)for(var o=this._elemAll("year","color",a),s=0,r=o.length;r>s;s++)_(o[s],h("year","color",a));d(e[t-i],h("year","color","0"));var l=1;for(a=t-1;a>=this._data._startYear&&n>l;a--,l++)d(e[a-i],h("year","color",l));for(l=1,a=t+1;a<=this._data._endYear&&n>l;a++,l++)d(e[a-i],h("year","color",l))},_delOpenedEvents:function(){this._domEvent.offAll("open")},_prepareYears:function(t){var e,i,n,a=this._current();return"string"==typeof t&&(e=t.trim().split(/[:,; ]/),i=parseInt(e[0],10),n=parseInt(e[1],10),isNaN(i)||isNaN(n)||(Math.abs(i)<1e3&&(i=a.year+i),Math.abs(n)<1e3&&(n=a.year+n))),{start:i||a.year-11,end:n||a.year+1}},_buttonText:function(){var t=this._currentDate,e=this.text("months"),i=this.text("caseMonths");return t.day+" "+(i||e)[t.month]+" "+t.year}});var h=function(t,e,i){return(null===i||void 0===i)&&(i=""),n+"__"+t+(e?"_"+e+(""===i?"":"_"+i):"")},l=function(t,e){return(null===e||void 0===e)&&(e=""),n+"_"+t+(""===e?"":"_"+e)},c=e.createElement("div"),u=c.dataset?function(t,e){return t.dataset[e]}:function(t,e){return t.getAttribute("data-"+e)},f=!!c.classList,d=f?function(t,e){return t.classList.add(e)}:function(t,e){var i=new RegExp("(^|\\s)"+e+"(\\s|$)","g");i.test(e.className)||(t.className=(t.className+" "+e).replace(/\s+/g," ").replace(/(^ | $)/g,""))},_=f?function(t,e){return t.classList.remove(e)}:function(t,e){var i=new RegExp("(^|\\s)"+e+"(\\s|$)","g");t.className=t.className.replace(i,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,"")},m=f?function(t,e){return t.classList.contains(e)}:function(t,e){var i=new RegExp("(^|\\s)"+e+"(\\s|$)","g");return-1!==t.className.search(i)};s(r.prototype,{_elem:function(t,e,i){return this._container.querySelector("."+h(t,e,i))},_elemAll:function(t,e,i){return this._container.querySelectorAll("."+h(t,e,i))},_left:function(t,e){t.style.left=e+"px"},_top:function(t,e){t.style.top=e+"px"},_position:function(t,e){this._left(t,e.left),this._top(t,e.top)},_offset:function(i){var n={top:0,left:0};return"undefined"!=typeof i.getBoundingClientRect&&(n=i.getBoundingClientRect()),{top:n.top+(t.pageYOffset||e.scrollTop||0)-(e.clientTop||0),left:n.left+(t.pageXOffset||e.scrollLeft||0)-(e.clientLeft||0)}}});var y=function(){};s(y.prototype,{set:function(t,e,i){this._buf=this._buf||[];var n=setTimeout(t,e);return this._buf.push({id:n,ns:i}),n},clear:function(t){this._buf&&this._buf.forEach(function(e,i){e.id===t&&(clearTimeout(t),this._buf.slice(i,1))},this)},clearAll:function(t){this._buf&&this._buf.forEach(function(e,i){t?t===e.ns&&(clearTimeout(e.id),this._buf.slice(i,1)):this._buf.slice(i,1)},this)}});var p="onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll";s(r.prototype,{on:function(t,e){return t&&e&&(this._eventBuf=this._eventBuf||[],this._eventBuf.push({type:t,callback:e})),this},off:function(t,e){return this._eventBuf&&this._eventBuf.forEach(function(i,n){t===i.type&&e===i.callback&&this._eventBuf.slice(n,1)}),this},trigger:function(t){var e=arguments;return t&&this._eventBuf&&this._eventBuf.forEach(function(i){t===i.type&&i.callback.apply(this,[{type:t}].concat(Array.prototype.slice.call(e,1)))},this),this}});var v=function(){};return s(v.prototype,{onWheel:function(e,i,n){return this.on(e,"DOMMouseScroll"===p?"MozMousePixelScroll":p,"wheel"===p?i:function(e){e||(e=t.event);var n={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"===e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}},a=-1/40;return"mousewheel"===p?(n.deltaY=a*e.wheelDelta,e.wheelDeltaX&&(n.deltaX=a*e.wheelDeltaX)):n.deltaY=e.detail,i(n)},n),this},on:function(t,e,i,n){return t&&e&&i&&(t.addEventListener(e,i,!1),this._buf=this._buf||[],this._buf.push({elem:t,type:e,callback:i,ns:n})),this},off:function(t,e,i,n){return t&&e&&i&&this._buf&&this._buf.forEach(function(a,o){a&&a.type===e&&a.elem===t&&a.callback===i&&a.ns===n&&(t.removeEventListener(e,i,!1),this._buf.slice(o,1))},this),this},offAll:function(t){return this._buf&&(this._buf.forEach(function(e){e&&this.off(e.elem,e.type,e.callback,t||e.ns)},this),t||(this._buf=[])),this}}),r.prototype.template=function(t){return this._templates[t]()},r.prototype._templates={prepare:function(t){return t.replace(/\$/g,n+"__")},attr:function(t,e){return""===t||null===t||void 0===t?"":" "+t+'="'+e+'"'},days:function(t){for(var e="",i=a;o>=i;i++)e+=this.month(i,t);return e},weekdays:function(){for(var t=this.parent.text("firstWeekDay")||0,e={first:t,last:t?t-1:6},i=t,n=0;7>n;n++)e[i]=n,i++,i>6&&(i=0);return e},month:function(t,e){var n=new Date(e,t,1,12,0,0),a=new Date,o=[a.getDate(),a.getMonth(),a.getFullYear()].join("-"),s=this.parent,r=n.getDay(),h=this.weekdays(),l=h[r],c=s.text("months")[t],u=[31,i(e)?29:28,31,30,31,30,31,31,30,31,30,31],f="",d=[],_=function(){return Array.prototype.join.call(arguments,"-")===o};d.push('<div class="$days-month">'),3>l&&d.push('<div class="$days-title-month">'+c+"</div>"),d.push('<table class="$days-table"><tr>'),r!==h.first&&d.push('<td colspan="'+l+'" class="$empty">'+(3>l?"":'<div class="$days-title-month">'+c+"</div>")+"</td>");for(var m,y,p,v=s._val.day,g=s._val.month,D=s._val.year,b=1;b<=u[t];b++)y="",m=!1,n.setDate(b),r=n.getDay(),p=this.parent.getHoliday(b,t,e),f=0===r||6===r?"$day_holiday":"$day_weekday",0===p?f="$day_weekday":1===p&&(f="$day_holiday"),b===v&&t===g&&e===D&&(f+=" $day_selected"),_(b,t,e)&&(f+=" $day_now",y=s.text("now")),d.push("<td"+this.attr("title",y)+' class="$day '+f+'" data-month="'+t+'" data-day="'+b+'">'+b+"</td>"),r===h.last&&(d.push("</tr>"),m=!0);return m||d.push("</tr>"),d.push("</table></div>"),d.join("")},years:function(){for(var t='<div class="$year-selector"><div class="$year-selector-i"></div></div>',e=this.parent._data._startYear,i=this.parent._data._endYear,n=e;i>=n;n++)t+='<div class="$year" data-year="'+n+'">'+n+"</div>";return t},months:function(){var t='<div class="$month-selector"><div class="$month-selector-i"></div></div>';return this.parent.text("months").forEach(function(e,i){t+='<div class="$month" data-month="'+i+'">'+e+"</div>"}),t},main:function(){var t=(this.parent.text("shortWeekDays"),this.parent.text("firstWeekDay")||0),e="";return this.parent.text("shortWeekDays").forEach(function(i,n,a){e+='<div class="$short-weekdays-cell $short-weekdays-cell_n_'+t+'"'+this.attr("title",a[t])+">"+a[t]+"</div>",t++,t>6&&(t=0)},this),this.prepare('<div class="$short-weekdays">'+e+'</div><div class="$container"><div class="$days">    <div class="$days-container">'+this.days(this.parent._currentDate.year)+'</div></div><div class="$months">'+this.months()+'</div><div class="$years"><div class="$years-container">'+this.years()+"</div></div></div>")}},s(r,{addHolidays:function(t,e){this._holidays=this._holidays||{},this._holidays[t]=e}}),r.prototype.getHoliday=function(t,e,i){var n=this._data.locale,a=r._holidays;return a&&a[n]&&a[n][i]?a[n][i][t+"-"+(e+1)]:void 0},s(r,{_texts:{},_locales:[],addLocale:function(t,e){this._locales.push(t),this._texts[t]=e,e.def&&(this._defaultLocale=t)}}),r.prototype.text=function(t){return r._texts[this._data.locale][t]},r.addLocale("be",{months:["студзень","люты","сакавік","красавік","май","чэрвень","ліпень","жнівень","верасень","кастрычнік","лістапад","снежань"],caseMonths:["студзеня","лютага","сакавіка","красавіка","траўня","траўня","ліпеня","жніўня","верасня","кастрычніка","лістапада","снежня"],shortWeekDays:["Н","П","А","С","Ч","П","С"],today:"Сення",firstWeekDay:1}),r.addLocale("de",{months:["Januar","Februar","Marz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortWeekDays:["So","Mo","Di","Mi","Do","Fr","Sa"],today:"Heute",firstWeekDay:1}),r.addLocale("en",{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortWeekDays:["Su","Mo","Tu","We","Th","Fr","Sa"],today:"Today",firstWeekDay:0,def:!0}),r.addLocale("es",{months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortWeekDays:["Do","Lu","Ma","Mi","Ju","Vi","Sá"],today:"Hoy",firstWeekDay:1}),r.addLocale("fr",{months:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],shortWeekDays:["Di","Lu","Ma","Me","Je","Ve","Sa"],today:"Aujourd’hui",firstWeekDay:1}),r.addLocale("it",{months:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],shortWeekDays:["Do","Lu","Ma","Me","Gi","Ve","Sa"],today:"Oggi",firstWeekDay:1}),r.addLocale("pl",{months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],caseMonths:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"],shortWeekDays:["N","P","W","Ś","C","P","S"],today:"Dziś",firstWeekDay:1}),r.addLocale("ru",{months:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],caseMonths:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],shortWeekDays:["В","П","В","С","Ч","П","С"],today:"Сегодня",firstWeekDay:1}),r.addLocale("tr",{months:["ocak","şubat","mart","nisan","mayıs","haziran","temmuz","ağustos","eylül","ekim","kasım","aralık"],shortWeekDays:["Pa","PT","Sa","Çarş","Per","CU","Ctesi"],today:"Bugün",firstWeekDay:1}),r.addLocale("uk",{months:["січень","лютий","березень","квітень","травень","червень","липень","серпень","вересень","жовтень","листопад","грудень"],caseMonths:["січня","лютого","березня","квітня","травня","червня","липня","серпня","вересня","жовтня","листопада","грудня"],shortWeekDays:["Н","П","В","С","Ч","П","С"],today:"Сьогодні",firstWeekDay:1}),r}(this,this.document);