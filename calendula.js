var Calendula=function(t,e){"use strict";function n(t){return(t%4||!(t%100))&&t%400?!1:!0}var s="calendula",a=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},i=function(t){t=a({},t||{});var e=new Date,n=this,t=a(t,{onselect:t.onselect||function(){},autoclose:"undefined"==typeof t.autoclose?!0:t.autoclose,theme:t.theme||"normal",lang:t.lang||i._defaultLang,startYear:t.startYear||e.getFullYear()-11,endYear:t.endYear||e.getFullYear()+1});return!this instanceof i&&(n=new i(t)),n._data=t,this.val(this._data.value),n};a(i.prototype,{init:function(){new Date;if(!this._isInited){this._templates.parent=this,this._isInited=!0;var t=e.createElement("div");this._container=t,t.classList.add(s),t.classList.add(r("theme",this._data.theme)),this._rebuild(),e.body.appendChild(t)}},isOpened:function(){return this._isOpened},open:function(){var t=this;return this.init(),this._ignoreDocumentClick=!0,this.isOpened()||(setTimeout(function(){t._container.classList.add(r("opened")),t._update(),t._monthSelector(t._currentDate.month),t._openedEvents()},1),this._isOpened=!0),this},close:function(){return this.init(),this.isOpened()&&(this._ignoreDocumentClick=!1,this._update(),this._container.classList.remove(r("opened")),this._delOpenedEvents(),this._isOpened=!1),this},toggle:function(){return this.isOpened()?this.close():this.open(),this},val:function(t){var e;return arguments.length?void(t?("string"==typeof t?e=Date.parse(t):"object"==typeof t?e=t instanceof Date?t:new Date(t.year,t.month,t.day,12,0,0,0):"number"==typeof number&&(e=new Date(t)),this._val={day:e.getDate(),month:e.getMonth(),year:e.getFullYear()},this._currentDate=a({},this._val)):(this._val={},this._currentDate=this._current())):this._val},_current:function(){var t=new Date;return{day:t.getDate(),month:t.getMonth(),year:t.getFullYear()}},_update:function(){this._isInited&&this.init();var t,e=this.setting("linkTo");e&&(t=this._offset(e),t.top+=e.offsetHeight,this._position(this._container,t))},setting:function(t,e){if(1===arguments.length)return this._data[t];var n=this._container;return"theme"===t&&n&&(n.classList.remove(r("theme",this._data.theme)),n.classList.add(r("theme",e))),this._data[t]=e,"lang"===t&&this._rebuild(),this},destroy:function(){this._isInited&&(this.close(),this._events.offAll(),e.body.removeChild(this._container),["_isInited","_container","_isOpened","_ignoreDocumentClick","_data"].forEach(function(t){delete this[t]},this))},_resize:function(){this._update()},_rebuild:function(){this._container.innerHTML=this.template("main")},_openedEvents:function(){var n=this;this._ignoreDocumentClick=!1,this._events.on(e,"click",function(t){!t.button&&n.setting("autoclose")&&(n._ignoreDocumentClick?n._ignoreDocumentClick=!1:n.close())},"open"),this._events.on(t,"resize",function(){n._resize()},"open"),this._events.on(this._container,"click",function(t){t.button||(n._ignoreDocumentClick=!0)},"open");var s=this._elem("months"),a=this._elem("days");this._onwheelmonths=function(t){var e=0;t.deltaY>0?e=1:t.deltaY<0&&(e=-1),e&&n._monthSelector(n._currentDate.month+e)},this._events.onWheel(s,this._onwheelmonths,"open"),this._events.onWheel(a,this._onwheelmonths,"open"),this._events.on(s,"click",function(t){t.button||t.target.classList.contains(o("month"))&&n._monthSelector(+t.target.dataset.month)},"open"),this._events.on(this._elem("years"),"click",function(t){t.button||t.target.dataset.year&&(n._currentDate.year=+t.target.dataset.year)},"open"),this._events.on(a,"click",function(t){if(!t.button){var e=o("day","selected"),s=t.target;if(s.dataset.day&&!s.classList.contains(e)){n._currentDate.month=+s.dataset.month,n._currentDate.day=+s.dataset.day;var i=a.querySelector("."+e);i&&i.classList.remove(e),s.classList.add(e),n.setting("onselect")({type:"select"},{day:n._currentDate.day,month:n._currentDate.month,year:n._currentDate.year}),n.close()}}},"open")},_monthSelector:function(t){0>t?t=0:t>11&&(t=11),this._currentDate.month=t;var e,n=this._elem("months"),s=this._elem("month").offsetHeight,a=this._elem("month-selector"),i=this._elem("days-container"),o=this._elem("days"),r=this._elemAll("days-month"),h=Math.floor(this._currentDate.month*s-s/2);0>=h&&(h=1),h+a.offsetHeight>=n.offsetHeight&&(h=n.offsetHeight-a.offsetHeight-1),this._top(this._elem("month-selector"),h),e=-Math.floor(r[t].offsetTop-o.offsetHeight/2+r[t].offsetHeight/2),e>0&&(e=0);var l=o.offsetHeight-i.offsetHeight;l>e&&(e=l),this._top(i,e)},_delOpenedEvents:function(){this._events.offAll("open")},_buttonText:function(){var t=this._current(),e=this.text("months"),n=this.text("caseMonths");return t.day+" "+(n||e)[t.month]+" "+t.year}});var o=function(t,e,n){return s+"__"+t+(e?"_"+e+(n?"_"+n:""):"")},r=function(t,e){return s+"_"+t+(e?"_"+e:"")};a(i.prototype,{_elem:function(t){return this._container.querySelector("."+o(t))},_elemAll:function(t){return this._container.querySelectorAll("."+o(t))},_left:function(t,e){t.style.left=e+"px"},_top:function(t,e){t.style.top=e+"px"},_position:function(t,e){this._left(t,e.left),this._top(t,e.top)},_offset:function(n){var s={top:0,left:0};return"undefined"!=typeof n.getBoundingClientRect&&(s=n.getBoundingClientRect()),{top:s.top+(t.pageYOffset||e.scrollTop||0)-(e.clientTop||0),left:s.left+(t.pageXOffset||e.scrollLeft||0)-(e.clientLeft||0)}}});var h="onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll";return i.prototype._events={_buf:[],onWheel:function(e,n){this.on(e,"DOMMouseScroll"===h?"MozMousePixelScroll":h,"wheel"===h?n:function(e){e||(e=t.event);var s={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"===e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"===h?(s.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(s.deltaX=-1/40*e.wheelDeltaX)):s.deltaY=e.detail,n(s)},!1)},on:function(t,e,n,s){t&&e&&n&&(t.addEventListener(e,n,!1),this._buf.push({elem:t,type:e,callback:n,ns:s}))},off:function(t,e,n,s){t&&e&&n&&(t.removeEventListener(e,n,!1),this._buf.forEach(function(a,i){a&&a.type===e&&a.elem===t&&n===a.callback&&s===s&&this._buf.slice(i,1)},this))},offAll:function(t){this._buf.forEach(function(e){e&&this.off(e.elem,e.type,e.callback,t||e.ns)},this),t||(this._buf=[])}},i.prototype.template=function(t){return this._templates[t]()},i.prototype._templates={_prepare:function(t){return t.replace(/\$/g,s+"__")},days:function(t){for(var e="",n=0;12>n;n++)e+=this.month(n,t);return e},month:function(t,e){var s=new Date(e,t,1,12,0,0),a=new Date,i=[a.getDate(),a.getMonth(),a.getFullYear()].join("-"),o=s.getDay(),r=this.text("firstWeekDay")||0,h=r?6:r-1,l={1:0,2:1,3:2,4:3,5:4,6:5,0:6},c=l[o],u=0,d=6,f=this.parent.text("months")[t],_=[31,n(e)?29:28,31,30,31,30,31,31,30,31,30,31],p="",m=[],y=function(){return Array.prototype.join.call(arguments,"-")===i};m.push('<div class="$days-month">'),3>c&&m.push('<div class="$days-title-month">'+f+"</div>"),m.push('<table class="$days-table"><tr>'),c>0&&m.push('<td colspan="'+c+'" class="$empty">'+(3>c?"":'<div class="$days-title-month">'+f+"</div>")+"</td>");for(var v,g,D=this.parent._val.day,k=this.parent._val.month,b=this.parent._val.year,w=1;w<=_[t];w++)g="",v=!1,s.setDate(w),o=s.getDay(),c=l[o],p=o===u||o===d?"$day_holiday":"$day_weekday",w===D&&t===k&&e===b&&(p+=" $day_selected"),y(w,t,e)&&(p+=" $day_now",g=this.parent.text("now")),m.push("<td"+(g?' title="'+g+'"':"")+' class="$day '+p+'" data-month="'+t+'" data-day="'+w+'">'+w+"</td>"),o===h&&(m.push("</tr>"),v=!0);return v||m.push("</tr>"),m.push("</table></div>"),m.join("")},years:function(){for(var t='<div class="$year-selector"><div class="$year-selector-i"></div></div>',e=this.parent._data.startYear,n=this.parent._data.endYear,s=e;n>=s;s++)t+='<div class="$year" data-year="'+s+'">'+s+"</div>";return t},months:function(){var t='<div class="$month-selector"><div class="$month-selector-i"></div></div>';return this.parent.text("months").forEach(function(e,n){t+='<div class="$month" data-month="'+n+'">'+e+"</div>"}),t},main:function(){var t=(this.parent.text("shortWeekDays"),this.parent.text("firstWeekDay")||0),e="";return this.parent.text("shortWeekDays").forEach(function(n,s,a){e+='<td class="$short-weekdays-cell $short-weekdays-cell_n_'+t+'">'+a[t]+"</td>",t++,t>6&&(t=0)}),this._prepare('<table class="$short-weekdays">'+e+'</table><div class="$container"><div class="$days">    <div class="$days-container">'+this.days(this.parent._currentDate.year)+'</div></div><div class="$months">'+this.months()+'</div><div class="$years">'+this.years()+"</div></div>")}},a(i,{_texts:{},_langs:[],addLocale:function(t,e){this._langs.push(t),this._texts[t]=e,e.def&&(this._defaultLang=t)}}),i.prototype.text=function(t){return i._texts[this._data.lang][t]},i.addLocale("en",{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortWeekDays:["Mon","Tu","Wed","Th","Fri","Sat","Su"],now:"Today",firstWeekDay:6}),i.addLocale("ru",{months:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],caseMonths:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],shortWeekDays:["П","В","С","Ч","П","С","В"],now:"Сегодня",firstWeekDay:0,def:!0}),i.addLocale("tr",{months:["ocak","şubat","mart","nisan","mayıs","haziran","temmuz","ağustos","eylül","ekim","kasım","aralık"],shortWeekDays:["PT","Sa","Çarş","Per","CU","Ctesi","Pa"],now:"Bugün",firstWeekDay:0}),i.addLocale("uk",{months:["січень","лютий","березень","квітень","травень","червень","липень","серпень","вересень","жовтень","листопад","грудень"],caseMonths:["січня","лютого","березня","квітня","травня","червня","липня","серпня","вересня","жовтня","листопада","грудня"],shortWeekDays:["П","В","С","Ч","П","С","Н"],now:"Сьогодні",firstWeekDay:0}),i}(this,this.document);