var Calendula=function(t,e){"use strict";function a(t){return(t%4||!(t%100))&&t%400?!1:!0}var s="calendula",n=0,i=11,o=function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a]);return t},r=function(t){t=o({},t||{});var e=(new Date,this),a=this._prepareYears(t.years),t=o(t,{onselect:t.onselect||function(){},autoclose:"undefined"==typeof t.autoclose?!0:t.autoclose,theme:t.theme||"normal",lang:t.lang||r._defaultLang,_startYear:a.start,_endYear:a.end});e._data=t,this.val(this._data.value)};o(r.prototype,{init:function(){new Date;if(!this._isInited){this._templates.parent=this,this._isInited=!0;var t=e.createElement("div");this._container=t,t.classList.add(s),t.classList.add(h("theme",this._data.theme)),this._rebuild(),e.body.appendChild(t)}},isOpened:function(){return this._isOpened},open:function(){var t=this;return this.init(),this._ignoreDocumentClick=!0,this.isOpened()||(setTimeout(function(){t._container.classList.add(h("opened")),t._update(),t._monthSelector(t._currentDate.month),t._yearSelector(t._currentDate.year),t._openedEvents()},1),this._isOpened=!0),this},close:function(){return this.init(),this.isOpened()&&(this._ignoreDocumentClick=!1,this._update(),this._container.classList.remove(h("opened")),this._delOpenedEvents(),this._isOpened=!1),this},toggle:function(){return this.isOpened()?this.close():this.open(),this},val:function(t){var e;return arguments.length?void(t?("string"==typeof t?e=Date.parse(t):"object"==typeof t?e=t instanceof Date?t:new Date(t.year,t.month,t.day,12,0,0,0):"number"==typeof number&&(e=new Date(t)),this._val={day:e.getDate(),month:e.getMonth(),year:e.getFullYear()},this._currentDate=o({},this._val)):(this._val={},this._currentDate=this._current())):this._val},setting:function(t,e){if(1===arguments.length)return this._data[t];var a=this._data[t],s=this._container;return this._data[t]=e,s&&("theme"===t&&(s.classList.remove(h("theme",a)),s.classList.add(h("theme",e))),"lang"===t&&this._rebuild()),this},destroy:function(){this._isInited&&(this.close(),this._events.offAll(),e.body.removeChild(this._container),["_isInited","_container","_isOpened","_ignoreDocumentClick","_data"].forEach(function(t){delete this[t]},this))},_current:function(){var t=new Date;return{day:t.getDate(),month:t.getMonth(),year:t.getFullYear()}},_update:function(){this._isInited&&this.init();var t,e=this.setting("linkTo");e&&(t=this._offset(e),t.top+=e.offsetHeight,this._position(this._container,t))},_resize:function(){this._update()},_rebuild:function(){this._container.innerHTML=this.template("main")},_rebuildDays:function(){this._elem("days-container").innerHTML=this._templates.prepare(this._templates.days(this._currentDate.year)),this._monthSelector(this._currentDate.month)},_openedEvents:function(){var a=this;this._ignoreDocumentClick=!1,this._events.on(e,"click",function(t){!t.button&&a.setting("autoclose")&&(a._ignoreDocumentClick?a._ignoreDocumentClick=!1:a.close())},"open"),this._events.on(t,"resize",function(){a._resize()},"open"),this._events.on(this._container,"click",function(t){t.button||(a._ignoreDocumentClick=!0)},"open");var s=this._elem("days"),n=this._elem("months"),i=this._elem("years");this._onwheelmonths=function(t){var e=0;t.deltaY>0?e=1:t.deltaY<0&&(e=-1),e&&a._monthSelector(a._currentDate.month+e)},this._onwheelyears=function(t){var e=0;t.deltaY>0?e=1:t.deltaY<0&&(e=-1),e&&a._yearSelector(a._currentDate.year+e)},this._events.onWheel(s,this._onwheelmonths,"open"),this._events.onWheel(n,this._onwheelmonths,"open"),this._events.onWheel(i,this._onwheelyears,"open"),this._events.on(n,"click",function(t){t.button||t.target.classList.contains(l("month"))&&a._monthSelector(+t.target.dataset.month)},"open"),this._events.on(i,"click",function(t){t.button||t.target.dataset.year&&a._yearSelector(+t.target.dataset.year)},"open"),this._events.on(s,"click",function(t){if(!t.button){var e=l("day","selected"),n=a._currentDate,i=t.target;if(i.dataset.day&&!i.classList.contains(e)){n.month=+i.dataset.month,n.day=+i.dataset.day;var o=s.querySelector("."+e);o&&o.classList.remove(e),i.classList.add(e),a.setting("onselect")({type:"select"},{day:n.day,month:n.month,year:n.year}),a.close()}}},"open")},_monthSelector:function(t){n>t?t=n:t>i&&(t=i),this._currentDate.month=t;var e,a=this._elem("months"),s=this._elem("month").offsetHeight,o=this._elemAll("days-month"),r=this._elem("month-selector"),l=this._elem("days-container"),h=this._elem("days"),c=Math.floor(this._currentDate.month*s-s/2);0>=c&&(c=1),c+r.offsetHeight>=a.offsetHeight&&(c=a.offsetHeight-r.offsetHeight-1),this._top(r,c),e=-Math.floor(o[t].offsetTop-h.offsetHeight/2+o[t].offsetHeight/2),e>0&&(e=0);var d=h.offsetHeight-l.offsetHeight;d>e&&(e=d),this._top(l,e),this._colorizeMonths(t)},_yearSelector:function(t){var e=this._data,a=e._startYear,s=e._endYear,n=this._currentDate.year;a>t?t=a:t>s&&(t=s),this._currentDate.year=t;var i=this._elem("years"),o=this._elem("years-container"),r=this._elem("year").offsetHeight,l=this._elem("year-selector"),a=this._data._startYear;s=this._data._endYear;var h=Math.floor((this._currentDate.year-a)*r),c=-Math.floor((this._currentDate.year-a)*r-i.offsetHeight/2);c>0&&(c=0),c<i.offsetHeight-o.offsetHeight&&(c=i.offsetHeight-o.offsetHeight);var d=0;i.offsetHeight>=o.offsetHeight&&((s-a+1)%2&&(d=r),c=Math.floor((i.offsetHeight-o.offsetHeight-d)/2)),t!==n&&this._rebuildDays(t),this._top(l,h),this._top(o,c),this._colorizeYears(t)},_colorizeMonths:function(t){for(var e=this._elemAll("month"),a=5,s=0;a>s;s++)for(var o=this._elemAll("month","color",s),r=0,h=o.length;h>r;r++)o[r].classList.remove(l("month","color",s));var c=l("month","color","0");e[t].classList.add(c),t-1>=n&&e[t-1].classList.add(c),i>=t+1&&e[t+1].classList.add(c);var d=1;for(s=t-2;s>=n&&a>d;s--,d++)e[s].classList.add(l("month","color",d));for(d=1,s=t+2;i>=s&&a>d;s++,d++)e[s].classList.add(l("month","color",d))},_colorizeYears:function(t){for(var e=this._elemAll("year"),a=this._data._startYear,s=5,n=0;s>n;n++)for(var i=this._elemAll("year","color",n),o=0,r=i.length;r>o;o++)i[o].classList.remove(l("year","color",n));e[t-a].classList.add(l("year","color","0"));var h=1;for(n=t-1;n>=this._data._startYear&&s>h;n--,h++)e[n-a].classList.add(l("year","color",h));for(h=1,n=t+1;n<=this._data.endYear&&s>h;n++,h++)e[n-a].classList.add(l("year","color",h))},_delOpenedEvents:function(){this._events.offAll("open")},_prepareYears:function(t){var e,a,s,n=this._current();return"string"==typeof t&&(e=t.trim().split(/[:,; ]/),a=parseInt(e[0],10),s=parseInt(e[1],10),isNaN(a)||isNaN(s)||(Math.abs(a)<1e3&&(a=n.year+a),Math.abs(s)<1e3&&(s=n.year+s))),{start:a||n.year-11,end:s||n.year+1}},_buttonText:function(){var t=this._currentDate,e=this.text("months"),a=this.text("caseMonths");return t.day+" "+(a||e)[t.month]+" "+t.year}});var l=function(t,e,a){return(null===a||void 0===a)&&(a=""),s+"__"+t+(e?"_"+e+(""===a?"":"_"+a):"")},h=function(t,e){return(null===e||void 0===e)&&(e=""),s+"_"+t+(""===e?"":"_"+e)};o(r.prototype,{_elem:function(t,e,a){return this._container.querySelector("."+l(t,e,a))},_elemAll:function(t,e,a){return this._container.querySelectorAll("."+l(t,e,a))},_left:function(t,e){t.style.left=e+"px"},_top:function(t,e){t.style.top=e+"px"},_position:function(t,e){this._left(t,e.left),this._top(t,e.top)},_offset:function(a){var s={top:0,left:0};return"undefined"!=typeof a.getBoundingClientRect&&(s=a.getBoundingClientRect()),{top:s.top+(t.pageYOffset||e.scrollTop||0)-(e.clientTop||0),left:s.left+(t.pageXOffset||e.scrollLeft||0)-(e.clientLeft||0)}}});var c="onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll";return r.prototype._events={_buf:[],onWheel:function(e,a){this.on(e,"DOMMouseScroll"===c?"MozMousePixelScroll":c,"wheel"===c?a:function(e){e||(e=t.event);var s={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"===e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"===c?(s.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(s.deltaX=-1/40*e.wheelDeltaX)):s.deltaY=e.detail,a(s)},!1)},on:function(t,e,a,s){t&&e&&a&&(t.addEventListener(e,a,!1),this._buf.push({elem:t,type:e,callback:a,ns:s}))},off:function(t,e,a,s){t&&e&&a&&(t.removeEventListener(e,a,!1),this._buf.forEach(function(n,i){n&&n.type===e&&n.elem===t&&a===n.callback&&s===s&&this._buf.slice(i,1)},this))},offAll:function(t){this._buf.forEach(function(e){e&&this.off(e.elem,e.type,e.callback,t||e.ns)},this),t||(this._buf=[])}},r.prototype.template=function(t){return this._templates[t]()},r.prototype._templates={prepare:function(t){return t.replace(/\$/g,s+"__")},attr:function(t,e){return""===t||null===t||void 0===t?"":" "+t+'="'+e+'"'},days:function(t){for(var e="",a=n;i>=a;a++)e+=this.month(a,t);return e},weekdays:function(){for(var t=this.parent.text("firstWeekDay")||0,e={first:t,last:t?t-1:6},a=t,s=0;7>s;s++)e[a]=s,a++,a>6&&(a=0);return e},month:function(t,e){var s=new Date(e,t,1,12,0,0),n=new Date,i=[n.getDate(),n.getMonth(),n.getFullYear()].join("-"),o=this.parent,r=s.getDay(),l=this.weekdays(),h=l[r],c=o.text("months")[t],d=[31,a(e)?29:28,31,30,31,30,31,31,30,31,30,31],u="",f=[],_=function(){return Array.prototype.join.call(arguments,"-")===i};f.push('<div class="$days-month">'),3>h&&f.push('<div class="$days-title-month">'+c+"</div>"),f.push('<table class="$days-table"><tr>'),r!==l.first&&f.push('<td colspan="'+h+'" class="$empty">'+(3>h?"":'<div class="$days-title-month">'+c+"</div>")+"</td>");for(var y,m,p=o._val.day,v=o._val.month,g=o._val.year,D=1;D<=d[t];D++)m="",y=!1,s.setDate(D),r=s.getDay(),u=0===r||6===r?"$day_holiday":"$day_weekday",D===p&&t===v&&e===g&&(u+=" $day_selected"),_(D,t,e)&&(u+=" $day_now",m=o.text("now")),f.push("<td"+this.attr("title",m)+' class="$day '+u+'" data-month="'+t+'" data-day="'+D+'">'+D+"</td>"),r===l.last&&(f.push("</tr>"),y=!0);return y||f.push("</tr>"),f.push("</table></div>"),f.join("")},years:function(){for(var t='<div class="$year-selector"><div class="$year-selector-i"></div></div>',e=this.parent._data._startYear,a=this.parent._data._endYear,s=e;a>=s;s++)t+='<div class="$year" data-year="'+s+'">'+s+"</div>";return t},months:function(){var t='<div class="$month-selector"><div class="$month-selector-i"></div></div>';return this.parent.text("months").forEach(function(e,a){t+='<div class="$month" data-month="'+a+'">'+e+"</div>"}),t},main:function(){var t=(this.parent.text("shortWeekDays"),this.parent.text("firstWeekDay")||0),e="";return this.parent.text("shortWeekDays").forEach(function(a,s,n){e+='<div class="$short-weekdays-cell $short-weekdays-cell_n_'+t+'"'+this.attr("title",n[t])+">"+n[t]+"</div>",t++,t>6&&(t=0)},this),this.prepare('<div class="$short-weekdays">'+e+'</div><div class="$container"><div class="$days">    <div class="$days-container">'+this.days(this.parent._currentDate.year)+'</div></div><div class="$months">'+this.months()+'</div><div class="$years"><div class="$years-container">'+this.years()+"</div></div></div>")}},o(r,{_texts:{},_langs:[],addLocale:function(t,e){this._langs.push(t),this._texts[t]=e,e.def&&(this._defaultLang=t)}}),r.prototype.text=function(t){return r._texts[this._data.lang][t]},r.addLocale("de",{months:["Januar","Februar","Marz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortWeekDays:["So","Mo","Di","Mi","Do","Fr","Sa"],today:"Heute",firstWeekDay:1}),r.addLocale("en",{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortWeekDays:["Su","Mo","Tu","We","Th","Fr","Sa"],today:"Today",firstWeekDay:0}),r.addLocale("es",{months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortWeekDays:["Do","Lu","Ma","Mi","Ju","Vi","Sá"],today:"Hoy",firstWeekDay:1}),r.addLocale("fr",{months:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],shortWeekDays:["Di","Lu","Ma","Me","Je","Ve","Sa"],today:"Aujourd’hui",firstWeekDay:1}),r.addLocale("it",{months:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],shortWeekDays:["Do","Lu","Ma","Me","Gi","Ve","Sa"],today:"Oggi",firstWeekDay:1}),r.addLocale("ru",{months:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],caseMonths:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],shortWeekDays:["В","П","В","С","Ч","П","С"],today:"Сегодня",firstWeekDay:1}),r.addLocale("tr",{months:["ocak","şubat","mart","nisan","mayıs","haziran","temmuz","ağustos","eylül","ekim","kasım","aralık"],shortWeekDays:["Pa","PT","Sa","Çarş","Per","CU","Ctesi"],today:"Bugün",firstWeekDay:1}),r.addLocale("uk",{months:["січень","лютий","березень","квітень","травень","червень","липень","серпень","вересень","жовтень","листопад","грудень"],caseMonths:["січня","лютого","березня","квітня","травня","червня","липня","серпня","вересня","жовтня","листопада","грудня"],shortWeekDays:["Н","П","В","С","Ч","П","С"],today:"Сьогодні",firstWeekDay:1}),r}(this,this.document);