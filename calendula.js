var Calendula=function(t,e){"use strict";function s(t){return(t%4||!(t%100))&&t%400?!1:!0}var n="calendula",i=function(t){var e=new Date;this._prefs=t||{lang:"ru",startYear:e.getFullYear()-11,endYear:e.getFullYear()+1}};i.prototype={init:function(){var t=new Date;if(!this._isInited){this._templates.parent=this,this._isInited=!0,this._day=t.getDate(),this._month=t.getMonth(),this._year=t.getFullYear();var s=e.createElement("div");s.classList.add(n),s.innerHTML=this.template("main"),e.body.appendChild(s),this._container=s}},setDate:function(){return this.update(),this},getDate:function(){return date},setPrefs:function(){return this},_elem:function(t){return this._container.querySelector("."+h(t))},_elemAll:function(t){return this._container.querySelectorAll("."+h(t))},_top:function(t,e){t.style.top=e+"px"},_openedEvents:function(){var s=this;this.events.on(e,"click",function(){console.log(1),s._ignoreDocumentClick?(console.log(2),s._ignoreDocumentClick=!1):s.close()},"open"),this.events.on(t,"resize",function(){s.resize()},"open"),this.events.on(this._container,"click",function(){s._ignoreDocumentClick=!0},"open");var n=this._elem("months"),i=this._elem("days");this._onwheelmonths=function(t){var e=0;t.deltaY>0?e=1:t.deltaY<0&&(e=-1),e&&s._monthSelector(s._month+e)},a(n,this._onwheelmonths),a(i,this._onwheelmonths),this.events.on(n,"click",function(t){t.target.classList.contains(h("month"))&&s._monthSelector(+t.target.dataset.month)},"open"),this.events.on(this._elem("years"),"click",function(t){t.target.dataset.year&&(s._year=+t.target.dataset.year)},"open"),this.events.on(i,"click",function(t){var e=h("day","selected"),n=t.target;if(n.dataset.day&&!n.classList.contains(e)){s._month=+n.dataset.month,s._day=+n.dataset.day;var o=i.querySelector("."+e);o&&o.classList.remove(e),n.classList.add(e)}},"open")},_monthSelector:function(t){0>t?t=0:t>11&&(t=11),this._month=t;var e,s=this._elem("months"),n=this._elem("month").offsetHeight,i=this._elem("month-selector"),o=this._elem("days-container"),a=this._elem("days"),r=this._elemAll("days-month"),h=Math.floor(this._month*n-n/2);0>=h&&(h=1),h+i.offsetHeight>=s.offsetHeight&&(h=s.offsetHeight-i.offsetHeight-1),this._top(this._elem("month-selector"),h),e=-Math.floor(r[t].offsetTop-a.offsetHeight/2+r[t].offsetHeight/2),e>0&&(e=0),e<a.offsetHeight-o.offsetHeight&&(e=a.offsetHeight-o.offsetHeight),this._top(o,e)},_delOpenedEvents:function(){this.events.offNS("open")},events:{_buf:[],on:function(t,e,s,n){t&&e&&s&&(t.addEventListener(e,s,!1),this._buf.push({elem:t,type:e,callback:s,ns:n}))},off:function(t,e,s,n){t&&e&&s&&(t.removeEventListener(e,s,!1),this._buf.forEach(function(i,o){i.type===e&&i.elem===t&&s===i.callback&&n===n&&(this._buf[o]=void 0)},this))},offNS:function(t){t?this._buf.forEach(function(e){t===e.ns&&this.off(e.elem,e.type,e.callback,t)},this):this.destroy()},destroy:function(){_buf.forEach(function(t){this.off(t.elem,t.type,t.callback)},this),this._buf=[]}},isOpened:function(){return this._isOpened},open:function(){var t=this;return this.init(),this.isOpened()||(this.update(),setTimeout(function(){t._container.classList.add(l("opened")),t._openedEvents()},1),this._isOpened=!0),this},close:function(){return this.init(),this.isOpened()&&(this.update(),this._container.classList.remove(l("opened")),this._delOpenedEvents(),this._isOpened=!1),this},toggle:function(){this.isOpened()?this.close():this.open()},update:function(){this._isInited&&this.init()},resize:function(){},destroy:function(){this._isInited&&(this._isInited=!1,delete this._container)}};var o="onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll",a=function(t,e){r(t,o,e),"DOMMouseScroll"===o&&r(t,"MozMousePixelScroll",e)},r=function(e,s,n){e.addEventListener(s,"wheel"===o?n:function(e){e||(e=t.event);var s={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"===e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}};return"mousewheel"===o?(s.deltaY=-1/40*e.wheelDelta,e.wheelDeltaX&&(s.deltaX=-1/40*e.wheelDeltaX)):s.deltaY=e.detail,n(s)},!1)};i.prototype.template=function(t){return this._templates[t]()},i.prototype._templates={_prepare:function(t){return t.replace(/\$/g,n+"__")},daysMonth:[31,28,31,30,31,30,31,31,30,31,30,31],days:function(t){for(var e="",s=0;s<this.daysMonth.length;s++)e+=this.month(s,t);return e},month:function(t,e){var n=new Date(e,t,1,12,0,0),i=n.getDay()-1,o=1,a=5,r=6,h=this.parent.text("months")[t],l="",c=[];this.daysMonth[o]=s(e)?29:28,c.push('<div class="$days-month">'),-1==i&&(i=r),3>i&&c.push('<div class="$days-title-month">'+h+"</div>"),c.push('<table class="$days-table"><tr>'),i>0&&c.push('<td colspan="'+i+'" class="$empty">'+(3>i?"":'<div class="$days-title-month">'+h+"</div>")+"</td>");for(var d,u=1;u<=this.daysMonth[t];u++)d=!1,n.setDate(u),i=n.getDay()-1,-1==i&&(i=r),l=i!=r&&i!=a?"$day_weekday":"$day_holiday",u===this.parent.day&&t===this.parent.month&&e===this.parent.year&&(l+=" $day_selected"),c.push('<td class="$day '+l+'" data-month="'+t+'" data-day="'+u+'">'+u+"</td>"),i===r&&(c.push("</tr>"),d=!0);return d||c.push("</tr>"),c.push("</table></div>"),c.join("")},years:function(){for(var t='<div class="$year-selector"><div class="$year-selector-i"></div></div>',e=this.parent._prefs.startYear,s=this.parent._prefs.endYear,n=e;s>=n;n++)t+='<div class="$year" data-year="'+n+'">'+n+"</div>";return t},months:function(){var t='<div class="$month-selector"><div class="$month-selector-i"></div></div>';return this.parent.text("months").forEach(function(e,s){t+='<div class="$month" data-month="'+s+'">'+e+"</div>"}),t},main:function(){var t="";return this.parent.text("shortWeekDays").forEach(function(e,s){t+='<td class="$short-weekdays-cell $short-weekdays-cell_n_'+s+'">'+e+"</td>"}),this._prepare('<table class="$short-weekdays">'+t+'</table><div class="$container"><div class="$days">    <div class="$days-container">'+this.days(this.parent._year)+'</div></div><div class="$months">'+this.months()+'</div><div class="$years">'+this.years()+"</div></div>")}};var h=function(t,e,s){return n+"__"+t+(e?"_"+e+(s?"_"+s:""):"")},l=function(t,e){return n+"_"+t+(e?"_"+e:"")};return i._texts={},i._langs=[],i.addLocale=function(t,e){this._langs.push(t),this._texts[t]=e},i.prototype.text=function(t){return i._texts[this._prefs.lang][t]},i.addLocale("be",{months:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],shortWeekDays:["П","В","С","Ч","П","С","В"]}),i.addLocale("en",{months:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],shortWeekDays:["П","В","С","Ч","П","С","В"]}),i.addLocale("ru",{months:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],shortWeekDays:["П","В","С","Ч","П","С","В"]}),i.addLocale("tr",{months:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],shortWeekDays:["П","В","С","Ч","П","С","В"]}),i.addLocale("uk",{months:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],shortWeekDays:["П","В","С","Ч","П","С","В"]}),i}(this,this.document);