var Calendula=function(t,e){"use strict";function n(t){return(t%4||!(t%100))&&t%400?!1:!0}var s="calendula",i=0,a=11,o=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},r=function(t){t=o({},t||{});var e=(new Date,this._prepareYears(t.years));this._data=o(t,{autoclose:"undefined"==typeof t.autoclose?!0:t.autoclose,lang:t.lang||r._defaultLang,theme:t.theme||"default",_startYear:e.start,_endYear:e.end}),this.val(this._data.value)};r.version="0.9.0",o(r.prototype,{isOpened:function(){return this._isOpened},open:function(){var t=this;return this._init(),this._ignoreDocumentClick=!0,this.isOpened()||(u.set(function(){t._container.classList.add(l("opened")),t._update(),t._monthSelector(t._currentDate.month,!1),t._yearSelector(t._currentDate.year,!1),t._openedEvents()},1,"open"),this._isOpened=!0,this.trigger("open")),this},close:function(){return this._init(),this.isOpened()&&(this._ignoreDocumentClick=!1,u.clearAll("open"),this._update(),this._container.classList.remove(l("opened")),this._delOpenedEvents(),this._isOpened=!1,this.trigger("close")),this},toggle:function(){return this.isOpened()?this.close():this.open(),this},val:function(t){var e;return arguments.length?void(t?("string"==typeof t?e=Date.parse(t):"object"==typeof t?e=t instanceof Date?t:new Date(t.year,t.month,t.day,12,0,0,0):"number"==typeof number&&(e=new Date(t)),this._val={day:e.getDate(),month:e.getMonth(),year:e.getFullYear()},this._currentDate=o({},this._val)):(this._val={},this._currentDate=this._current())):this._val},setting:function(t,e){if(1===arguments.length)return this._data[t];var n=this._data[t],s=this._container;return this._data[t]=e,s&&("theme"===t&&(s.classList.remove(l("theme",n)),s.classList.add(l("theme",e))),"lang"===t&&this._rebuild()),this},destroy:function(){this._isInited&&(this.close(),u.clearAll(),this._eventBuf=[],this._domEvent.offAll(),e.body.removeChild(this._container),["_isInited","_container","_isOpened","_ignoreDocumentClick","_data"].forEach(function(t){delete this[t]},this))},_init:function(){if(!this._isInited){this._templates.parent=this,this._isInited=!0;var t=this,n=this.setting("button"),i=e.createElement("div");this._container=i,i.classList.add(s),i.classList.add(l("theme",this._data.theme)),n&&this._domEvent.on(n,"click",function(){t.toggle()},"init"),this._rebuild(),e.body.appendChild(i)}},_current:function(){var t=new Date;return{day:t.getDate(),month:t.getMonth(),year:t.getFullYear()}},_update:function(){this._init();var t,e=this.setting("button");e&&(t=this._offset(e),t.top+=e.offsetHeight,this._position(this._container,t))},_resize:function(){this._update()},_rebuild:function(){this._container.innerHTML=this.template("main")},_rebuildDays:function(){this._elem("days-container").innerHTML=this._templates.prepare(this._templates.days(this._currentDate.year)),this._monthSelector(this._currentDate.month,!1)},_openedEvents:function(){var n=this;this._ignoreDocumentClick=!1,this._domEvent.on(e,"click",function(t){!t.button&&n.setting("autoclose")&&(n._ignoreDocumentClick?n._ignoreDocumentClick=!1:n.close())},"open"),this._domEvent.on(t,"resize",function(){n._resize()},"open"),this._domEvent.on(e,"keypress",function(t){27===t.keyCode&&n.close()},"open"),this._domEvent.on(this._container,"click",function(t){t.button||(n._ignoreDocumentClick=!0)},"open");var s=this._elem("days"),i=this._elem("months"),a=this._elem("years");this._onwheelmonths=function(t){var e=0;t.deltaY>0?e=1:t.deltaY<0&&(e=-1),e&&(n._monthSelector(n._currentDate.month+e,!0),t.preventDefault())},this._onwheelyears=function(t){var e=0;t.deltaY>0?e=1:t.deltaY<0&&(e=-1),e&&(n._yearSelector(n._currentDate.year+e,!0),t.preventDefault())},this._domEvent.onWheel(s,this._onwheelmonths,"open"),this._domEvent.onWheel(i,this._onwheelmonths,"open"),this._domEvent.onWheel(a,this._onwheelyears,"open"),this._domEvent.on(i,"click",function(t){t.button||t.target.classList.contains(h("month"))&&n._monthSelector(+c(t.target,"month"),!0)},"open"),this._domEvent.on(a,"click",function(t){if(!t.button){var e=c(t.target,"year");e&&n._yearSelector(+e,!0)}},"open"),this._domEvent.on(s,"click",function(t){if(!t.button){var e=h("day","selected"),i=n._currentDate,a=t.target,o=c(a,"day"),r=c(a,"month");if(o&&!a.classList.contains(e)){i.day=+o,i.month=+r;var l=s.querySelector("."+e);l&&l.classList.remove(e),a.classList.add(e),n.trigger("select",{day:i.day,month:i.month,year:i.year}).close()}}},"open")},_monthSelector:function(t,e){i>t?t=i:t>a&&(t=a),this._currentDate.month=t;var n,s=this._elem("months"),o=this._elem("month").offsetHeight,r=this._elemAll("days-month"),l=this._elem("month-selector"),c=this._elem("days-container"),f=this._elem("days"),d=h("days","noanim"),_=h("months","noanim");e||(f.classList.add(d),s.classList.add(_));var m=Math.floor(this._currentDate.month*o-o/2);0>=m&&(m=1),m+l.offsetHeight>=s.offsetHeight&&(m=s.offsetHeight-l.offsetHeight-1),this._top(l,m),n=-Math.floor(r[t].offsetTop-f.offsetHeight/2+r[t].offsetHeight/2),n>0&&(n=0);var v=f.offsetHeight-c.offsetHeight;v>n&&(n=v),this._top(c,n),this._colorizeMonths(t),e||u.set(function(){f.classList.remove(d),s.classList.remove(_)},0,"anim")},_yearSelector:function(t,e){var n=this._data,s=n._startYear,i=n._endYear,a=this._currentDate.year;s>t?t=s:t>i&&(t=i),this._currentDate.year=t;var o=this._elem("years"),r=this._elem("years-container"),l=this._elem("year").offsetHeight,c=this._elem("year-selector"),s=this._data._startYear,i=this._data._endYear,f=h("years","noanim");e||o.classList.add(f);var d=Math.floor((this._currentDate.year-s)*l),_=-Math.floor((this._currentDate.year-s)*l-o.offsetHeight/2);_>0&&(_=0),_<o.offsetHeight-r.offsetHeight&&(_=o.offsetHeight-r.offsetHeight);var m=0;o.offsetHeight>=r.offsetHeight&&((i-s+1)%2&&(m=l),_=Math.floor((o.offsetHeight-r.offsetHeight-m)/2)),t!==a&&this._rebuildDays(t),this._top(c,d),this._top(r,_),this._colorizeYears(t),e||u.set(function(){o.classList.remove(f)},0,"anim")},_colorizeMonths:function(t){for(var e=this._elemAll("month"),n=5,s=0;n>s;s++)for(var o=this._elemAll("month","color",s),r=0,l=o.length;l>r;r++)o[r].classList.remove(h("month","color",s));var c=h("month","color","0");e[t].classList.add(c),t-1>=i&&e[t-1].classList.add(c),a>=t+1&&e[t+1].classList.add(c);var u=1;for(s=t-2;s>=i&&n>u;s--,u++)e[s].classList.add(h("month","color",u));for(u=1,s=t+2;a>=s&&n>u;s++,u++)e[s].classList.add(h("month","color",u))},_colorizeYears:function(t){for(var e=this._elemAll("year"),n=this._data._startYear,s=5,i=0;s>i;i++)for(var a=this._elemAll("year","color",i),o=0,r=a.length;r>o;o++)a[o].classList.remove(h("year","color",i));e[t-n].classList.add(h("year","color","0"));var l=1;for(i=t-1;i>=this._data._startYear&&s>l;i--,l++)e[i-n].classList.add(h("year","color",l));for(l=1,i=t+1;i<=this._data._endYear&&s>l;i++,l++)e[i-n].classList.add(h("year","color",l))},_delOpenedEvents:function(){this._domEvent.offAll("open")},_prepareYears:function(t){var e,n,s,i=this._current();return"string"==typeof t&&(e=t.trim().split(/[:,; ]/),n=parseInt(e[0],10),s=parseInt(e[1],10),isNaN(n)||isNaN(s)||(Math.abs(n)<1e3&&(n=i.year+n),Math.abs(s)<1e3&&(s=i.year+s))),{start:n||i.year-11,end:s||i.year+1}},_buttonText:function(){var t=this._currentDate,e=this.text("months"),n=this.text("caseMonths");return t.day+" "+(n||e)[t.month]+" "+t.year}});var h=function(t,e,n){return(null===n||void 0===n)&&(n=""),s+"__"+t+(e?"_"+e+(""===n?"":"_"+n):"")},l=function(t,e){return(null===e||void 0===e)&&(e=""),s+"_"+t+(""===e?"":"_"+e)};o(r.prototype,{_elem:function(t,e,n){return this._container.querySelector("."+h(t,e,n))},_elemAll:function(t,e,n){return this._container.querySelectorAll("."+h(t,e,n))},_left:function(t,e){t.style.left=e+"px"},_top:function(t,e){t.style.top=e+"px"},_position:function(t,e){this._left(t,e.left),this._top(t,e.top)},_offset:function(n){var s={top:0,left:0};return"undefined"!=typeof n.getBoundingClientRect&&(s=n.getBoundingClientRect()),{top:s.top+(t.pageYOffset||e.scrollTop||0)-(e.clientTop||0),left:s.left+(t.pageXOffset||e.scrollLeft||0)-(e.clientLeft||0)}}});var c=e.createElement("div").classList?function(t,e){return t.dataset[e]}:function(t,e){return t.getAttribute("data-"+e)},u={_buf:[],set:function(t,e,n){this._buf.push({id:setTimeout(t,e),ns:n})},clear:function(t){this._buf.forEach(function(e,n){e.id===t&&(clearTimeout(t),this._buf.slice(n,1))},this)},clearAll:function(t){this._buf.forEach(function(e,n){t?t===e.ns&&(clearTimeout(e.id),this._buf.slice(n,1)):this._buf.slice(n,1)},this)}},f="onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll";return o(r.prototype,{on:function(t,e){return t&&e&&(this._eventBuf=this._eventBuf||[],this._eventBuf.push({type:t,callback:e})),this},off:function(t,e){return this._eventBuf&&this._eventBuf.forEach(function(n,s){t===n.type&&e===n.callback&&this._eventBuf.slice(s,1)}),this},trigger:function(t){var e=arguments;return t&&this._eventBuf&&this._eventBuf.forEach(function(n){t===n.type&&n.callback.apply(this,[{type:t}].concat(Array.prototype.slice.call(e,1)))},this),this},_domEvent:{onWheel:function(e,n,s){return this.on(e,"DOMMouseScroll"===f?"MozMousePixelScroll":f,"wheel"===f?n:function(e){e||(e=t.event);var s={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"===e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}},i=-1/40;return"mousewheel"===f?(s.deltaY=i*e.wheelDelta,e.wheelDeltaX&&(s.deltaX=i*e.wheelDeltaX)):s.deltaY=e.detail,n(s)},s),this},on:function(t,e,n,s){return t&&e&&n&&(t.addEventListener(e,n,!1),this._buf=this._buf||[],this._buf.push({elem:t,type:e,callback:n,ns:s})),this},off:function(t,e,n,s){return t&&e&&n&&this._buf&&this._buf.forEach(function(i,a){i&&i.type===e&&i.elem===t&&i.callback===n&&i.ns===s&&(t.removeEventListener(e,n,!1),this._buf.slice(a,1))},this),this},offAll:function(t){return this._buf&&(this._buf.forEach(function(e){e&&this.off(e.elem,e.type,e.callback,t||e.ns)},this),t||(this._buf=[])),this}}}),r.prototype.template=function(t){return this._templates[t]()},r.prototype._templates={prepare:function(t){return t.replace(/\$/g,s+"__")},attr:function(t,e){return""===t||null===t||void 0===t?"":" "+t+'="'+e+'"'},days:function(t){for(var e="",n=i;a>=n;n++)e+=this.month(n,t);return e},weekdays:function(){for(var t=this.parent.text("firstWeekDay")||0,e={first:t,last:t?t-1:6},n=t,s=0;7>s;s++)e[n]=s,n++,n>6&&(n=0);return e},month:function(t,e){var s=new Date(e,t,1,12,0,0),i=new Date,a=[i.getDate(),i.getMonth(),i.getFullYear()].join("-"),o=this.parent,r=s.getDay(),h=this.weekdays(),l=h[r],c=o.text("months")[t],u=[31,n(e)?29:28,31,30,31,30,31,31,30,31,30,31],f="",d=[],_=function(){return Array.prototype.join.call(arguments,"-")===a};d.push('<div class="$days-month">'),3>l&&d.push('<div class="$days-title-month">'+c+"</div>"),d.push('<table class="$days-table"><tr>'),r!==h.first&&d.push('<td colspan="'+l+'" class="$empty">'+(3>l?"":'<div class="$days-title-month">'+c+"</div>")+"</td>");for(var m,v,p=o._val.day,y=o._val.month,g=o._val.year,D=1;D<=u[t];D++)v="",m=!1,s.setDate(D),r=s.getDay(),f=0===r||6===r?"$day_holiday":"$day_weekday",D===p&&t===y&&e===g&&(f+=" $day_selected"),_(D,t,e)&&(f+=" $day_now",v=o.text("now")),d.push("<td"+this.attr("title",v)+' class="$day '+f+'" data-month="'+t+'" data-day="'+D+'">'+D+"</td>"),r===h.last&&(d.push("</tr>"),m=!0);return m||d.push("</tr>"),d.push("</table></div>"),d.join("")},years:function(){for(var t='<div class="$year-selector"><div class="$year-selector-i"></div></div>',e=this.parent._data._startYear,n=this.parent._data._endYear,s=e;n>=s;s++)t+='<div class="$year" data-year="'+s+'">'+s+"</div>";return t},months:function(){var t='<div class="$month-selector"><div class="$month-selector-i"></div></div>';return this.parent.text("months").forEach(function(e,n){t+='<div class="$month" data-month="'+n+'">'+e+"</div>"}),t},main:function(){var t=(this.parent.text("shortWeekDays"),this.parent.text("firstWeekDay")||0),e="";return this.parent.text("shortWeekDays").forEach(function(n,s,i){e+='<div class="$short-weekdays-cell $short-weekdays-cell_n_'+t+'"'+this.attr("title",i[t])+">"+i[t]+"</div>",t++,t>6&&(t=0)},this),this.prepare('<div class="$short-weekdays">'+e+'</div><div class="$container"><div class="$days">    <div class="$days-container">'+this.days(this.parent._currentDate.year)+'</div></div><div class="$months">'+this.months()+'</div><div class="$years"><div class="$years-container">'+this.years()+"</div></div></div>")}},o(r,{_texts:{},_langs:[],addLocale:function(t,e){this._langs.push(t),this._texts[t]=e,e.def&&(this._defaultLang=t)}}),r.prototype.text=function(t){return r._texts[this._data.lang][t]},r}(this,this.document);