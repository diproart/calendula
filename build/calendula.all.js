var Calendula=function(t,e){"use strict";function n(t){return(10>t?"0":"")+t}function a(t){return(t%4||!(t%100))&&t%400?!1:!0}var i="calendula",o=0,r=11,s=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},l=function(t){t=s({},t||{});var e=this._prepareYears(t.years),n=this;this._data=s(t,{autoclose:"undefined"==typeof t.autoclose?!0:t.autoclose,closeAfterSelection:"undefined"==typeof t.closeAfterSelection?!0:t.closeAfterSelection,locale:t.locale||l._defaultLocale,theme:t.theme||"default",min:this._parseDateToObj(t.min),max:this._parseDateToObj(t.max),_startYear:e.start,_endYear:e.end}),this._domEvent=new M,this.val(this._data.value);var a=this.setting("button");a&&this._domEvent.on(a,"click",function(){n.toggle()},"init")};l.version="0.9.0",s(l.prototype,{isOpened:function(){return this._isOpened},open:function(){var t=this;return this._init(),this._ignoreDocumentClick=!0,this.isOpened()||(this._timeout.set(function(){_(t._container,c("opened")),t._update(),t._monthSelector(t._currentDate.month,!1),t._yearSelector(t._currentDate.year,!1),t._openedEvents()},1,"open"),this._isOpened=!0,this.trigger("open")),this},close:function(){return this._init(),this.isOpened()&&(this._ignoreDocumentClick=!1,this._timeout.clearAll("open"),this._update(),this._delOpenedEvents(),m(this._container,c("opened")),this._isOpened=!1,this.trigger("close")),this},toggle:function(){return this.isOpened()?this.close():this.open(),this},val:function(t){return arguments.length?(t?(this._val=this._parseDateToObj(t),this._currentDate=s({},this._val)):(this._val={},this._currentDate=this._current()),this._container&&this._updateSelection(),void this._updateButton()):this._val},setting:function(t,e){if(1===arguments.length)return this._data[t];var n,a=this._data[t],i=this._container,o={min:!0,max:!0,locale:!0};return this._data[t]="min"===t||"max"===t||"value"===t?this._parseDateToObj(e):e,i&&("theme"===t&&(m(i,c("theme",a)),_(i,c("theme",e))),"daysAfterMonths"===t&&(n=c("days-after-months"),e?_(i,n):m(i,n)),o[t]&&this._rebuild()),this},destroy:function(){this._isInited&&(this.close(),this._timeout.clearAll(),this._eventBuf=[],this._domEvent.offAll(),e.body.removeChild(this._container),["_container","_data","_domEvent","_ignoreDocumentClick","_isInited","_isOpened","_timeout"].forEach(function(t){delete this[t]},this))},_init:function(){if(!this._isInited){this._isInited=!0,this._timeout=new D,this._templates.parent=this;var t=this.setting("id"),n=e.createElement("div");this._container=n,t&&(n.id=t),_(n,i),_(n,c("theme",this._data.theme)),this.setting("daysAfterMonths")&&_(n,c("days-after-months")),this._rebuild(),e.body.appendChild(n)}},_current:function(){var t=new Date;return{day:t.getDate(),month:t.getMonth(),year:t.getFullYear()}},_update:function(){this._init();var t,e=this.setting("button");e&&(t=this._offset(e),t.top+=e.offsetHeight,this._position(this._container,t))},_resize:function(){this._update()},_rebuild:function(){this._container.innerHTML=this.template("main")},_rebuildDays:function(){this._elem("days-container").innerHTML=this.template("days"),this._monthSelector(this._currentDate.month,!1)},_openedEvents:function(){var n=this;this._ignoreDocumentClick=!1,this._domEvent.on(e,"click",function(t){!t.button&&n.setting("autoclose")&&(n._ignoreDocumentClick?n._ignoreDocumentClick=!1:n.close())},"open"),this._domEvent.on(t,"resize",function(){n._resize()},"open"),this._domEvent.on(e,"keypress",function(t){27===t.keyCode&&n.close()},"open"),this._domEvent.on(this._container,"click",function(t){t.button||(n._ignoreDocumentClick=!0)},"open");var a=this._elem("days"),i=this._elem("months"),o=this._elem("years");this._onwheelmonths=function(t){var e=0;t.deltaY>0?e=1:t.deltaY<0&&(e=-1),e&&(n._monthSelector(n._currentDate.month+e,!0),t.preventDefault())},this._onwheelyears=function(t){var e=0;t.deltaY>0?e=1:t.deltaY<0&&(e=-1),e&&(n._yearSelector(n._currentDate.year+e,!0),t.preventDefault())},this._domEvent.onWheel(a,this._onwheelmonths,"open"),this._domEvent.onWheel(i,this._onwheelmonths,"open"),this._domEvent.onWheel(o,this._onwheelyears,"open"),this._domEvent.on(i,"click",function(t){t.button||y(t.target,h("month"))&&n._monthSelector(+f(t.target,"month"),!0)},"open"),this._domEvent.on(o,"click",function(t){if(!t.button){var e=f(t.target,"year");e&&n._yearSelector(+e,!0)}},"open"),this._domEvent.on(a,"click",function(t){if(!t.button){var e=h("day","selected"),i=n._currentDate,o=t.target,r=f(o,"day"),s=f(o,"month");if(r){if(y(o,h("day","minmax")))return;if(!y(o,e)){i.day=+r,i.month=+s;var l=a.querySelector("."+e);l&&m(l,e),_(o,e),n.trigger("select",{day:i.day,month:i.month,year:i.year}),n.setting("closeAfterSelection")&&n.close()}}}},"open")},_monthSelector:function(t,e){o>t?t=o:t>r&&(t=r),this._currentDate.month=t;var n,a=this._elem("months"),i=this._elem("month").offsetHeight,s=this._elemAll("days-month"),l=s[t],c=this._elem("month-selector"),u=this._elem("days-container"),f=this._elem("days"),d=h("days","noanim"),y=h("months","noanim");e||(_(f,d),_(a,y));var p=Math.floor(this._currentDate.month*i-i/2);0>=p&&(p=1),p+c.offsetHeight>=a.offsetHeight&&(p=a.offsetHeight-c.offsetHeight-1),this._top(c,p),n=-Math.floor(l.offsetTop-f.offsetHeight/2+l.offsetHeight/2),n>0&&(n=0);var v=f.offsetHeight-u.offsetHeight;v>n&&(n=v),this._top(u,n),this._colorizeMonths(t),e||this._timeout.set(function(){m(f,d),m(a,y)},0,"anim")},_yearSelector:function(t,e){var n=this._data,a=n._startYear,i=n._endYear,o=this._currentDate.year;a>t?t=a:t>i&&(t=i),this._currentDate.year=t;var r=this._elem("years"),s=this._elem("years-container"),l=this._elem("year").offsetHeight,c=this._elem("year-selector"),u=h("years","noanim");e||_(r,u);var f=Math.floor((this._currentDate.year-a)*l),d=-Math.floor((this._currentDate.year-a)*l-r.offsetHeight/2);d>0&&(d=0),d<r.offsetHeight-s.offsetHeight&&(d=r.offsetHeight-s.offsetHeight);var y=0;r.offsetHeight>=s.offsetHeight&&((i-a+1)%2&&(y=l),d=Math.floor((r.offsetHeight-s.offsetHeight-y)/2)),t!==o&&this._rebuildDays(t),this._top(c,f),this._top(s,d),this._colorizeYears(t),e||this._timeout.set(function(){m(r,u)},0,"anim")},_colorizeMonths:function(t){for(var e=this._elemAll("month"),n=5,a=0;n>a;a++)for(var i=this._elemAll("month","color",a),s=0,l=i.length;l>s;s++)m(i[s],h("month","color",a));var c=h("month","color","0");_(e[t],c),t-1>=o&&_(e[t-1],c),r>=t+1&&_(e[t+1],c);var u=1;for(a=t-2;a>=o&&n>u;a--,u++)_(e[a],h("month","color",u));for(u=1,a=t+2;r>=a&&n>u;a++,u++)_(e[a],h("month","color",u))},_colorizeYears:function(t){for(var e=this._elemAll("year"),n=this._data._startYear,a=5,i=0;a>i;i++)for(var o=this._elemAll("year","color",i),r=0,s=o.length;s>r;r++)m(o[r],h("year","color",i));_(e[t-n],h("year","color","0"));var l=1;for(i=t-1;i>=this._data._startYear&&a>l;i--,l++)_(e[i-n],h("year","color",l));for(l=1,i=t+1;i<=this._data._endYear&&a>l;i++,l++)_(e[i-n],h("year","color",l))},_delOpenedEvents:function(){this._domEvent.offAll("open")},_prepareYears:function(t){var e,n,a,i=this._current();return"string"==typeof t&&(e=t.trim().split(/[:,; ]/),n=g(e[0]),a=g(e[1]),isNaN(n)||isNaN(a)||(Math.abs(n)<1e3&&(n=i.year+n),Math.abs(a)<1e3&&(a=i.year+a))),{start:n||i.year-11,end:a||i.year+1}},_updateSelection:function(){var t,e=this._elem("day","selected");e&&m(e,h("day","selected")),this._currentDate.year===this._val.year&&(t=this._elemAll("days-month"),t&&t[this._val.month]&&(e=this._elemAllContext(t[this._val.month],"day"),e&&e[this._val.day-1]&&_(e[this._val.day-1],h("day","selected"))))},_updateButton:function(){var t,e=this.setting("button"),n=this._buttonText();e&&(t=e.tagName.toLowerCase(),"input"===t||"textarea"===t?e.value=n:e.innerHTML=n)},_buttonText:function(){var t=this._currentDate,e=this.text("months"),n=this.text("caseMonths");return t.day+" "+(n||e)[t.month]+" "+t.year}});var h=function(t,e,n){return(null===n||void 0===n)&&(n=""),i+"__"+t+(e?"_"+e+(""===n?"":"_"+n):"")},c=function(t,e){return(null===e||void 0===e)&&(e=""),i+"_"+t+(""===e?"":"_"+e)},u=e.createElement("div"),f=u.dataset?function(t,e){return t.dataset[e]}:function(t,e){return t.getAttribute("data-"+e)},d=!!u.classList,_=d?function(t,e){return t.classList.add(e)}:function(t,e){var n=new RegExp("(^|\\s)"+e+"(\\s|$)","g");n.test(e.className)||(t.className=(t.className+" "+e).replace(/\s+/g," ").replace(/(^ | $)/g,""))},m=d?function(t,e){return t.classList.remove(e)}:function(t,e){var n=new RegExp("(^|\\s)"+e+"(\\s|$)","g");t.className=t.className.replace(n,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,"")},y=d?function(t,e){return t.classList.contains(e)}:function(t,e){var n=new RegExp("(^|\\s)"+e+"(\\s|$)","g");return-1!==t.className.search(n)};s(l.prototype,{_elem:function(t,e,n){return this._container.querySelector("."+h(t,e,n))},_elemContext:function(t,e,n,a){return t.querySelector("."+h(e,n,a))},_elemAll:function(t,e,n){return this._container.querySelectorAll("."+h(t,e,n))},_elemAllContext:function(t,e,n,a){return t.querySelectorAll("."+h(e,n,a))}});var p=Array.isArray,v=function(t){return"[object Object]"===Object.prototype.toString.call(t)};s(l.prototype,{_left:function(t,e){t.style.left=e+"px"},_top:function(t,e){t.style.top=e+"px"},_position:function(t,e){this._left(t,e.left),this._top(t,e.top)},_offset:function(n){var a={top:0,left:0};return"undefined"!=typeof n.getBoundingClientRect&&(a=n.getBoundingClientRect()),{top:a.top+(t.pageYOffset||e.scrollTop||0)-(e.clientTop||0),left:a.left+(t.pageXOffset||e.scrollLeft||0)-(e.clientLeft||0)}}});var g=function(t){return parseInt(t,10)},b=function(){var t=function(n){if(null===n||void 0===n)return"";var a=[];if(v(n))return e(n);if(p(n)){for(var i=0,o=n.length;o>i;i++)a.push(t(n[i]));return a.join("")}return""+n},e=function(e){var a=e.t||"div",i="<"+a+n(e)+">";return e.c&&(i+=t(e.c)),i+="</"+a+">"},n=function(t){var e=Object.keys(t),n=["cl","class","c","t"],i=t.cl||t["class"],o=[],r="";i&&o.push(a("class",i));for(var s=0,l=e.length;l>s;s++){var h=e[s];-1===n.indexOf(h)&&o.push(a(h,t[h]))}return r=o.join(" "),r?" "+r:""},a=function(t,e){return null!==e&&void 0!==e?t+'="'+(p(e)?e.join(" "):e)+'"':""};return t}(),D=function(){};s(D.prototype,{set:function(t,e,n){this._buf=this._buf||[];var a=setTimeout(t,e);return this._buf.push({id:a,ns:n}),a},clear:function(t){this._buf&&this._buf.forEach(function(e,n){e.id===t&&(clearTimeout(t),this._buf.slice(n,1))},this)},clearAll:function(t){this._buf&&this._buf.forEach(function(e,n){t?t===e.ns&&(clearTimeout(e.id),this._buf.slice(n,1)):this._buf.slice(n,1)},this)}});var k="onwheel"in e.createElement("div")?"wheel":void 0!==e.onmousewheel?"mousewheel":"DOMMouseScroll";s(l.prototype,{on:function(t,e){return t&&e&&(this._eventBuf=this._eventBuf||[],this._eventBuf.push({type:t,callback:e})),this},off:function(t,e){return this._eventBuf&&this._eventBuf.forEach(function(n,a){t===n.type&&e===n.callback&&this._eventBuf.slice(a,1)}),this},trigger:function(t){var e=arguments;return t&&this._eventBuf&&this._eventBuf.forEach(function(n){t===n.type&&n.callback.apply(this,[{type:t}].concat(Array.prototype.slice.call(e,1)))},this),this}});var M=function(){};s(M.prototype,{onWheel:function(e,n,a){return this.on(e,"DOMMouseScroll"===k?"MozMousePixelScroll":k,"wheel"===k?n:function(e){e||(e=t.event);var a={originalEvent:e,target:e.target||e.srcElement,type:"wheel",deltaMode:"MozMousePixelScroll"===e.type?0:1,deltaX:0,delatZ:0,preventDefault:function(){e.preventDefault?e.preventDefault():e.returnValue=!1}},i=-1/40;return"mousewheel"===k?(a.deltaY=i*e.wheelDelta,e.wheelDeltaX&&(a.deltaX=i*e.wheelDeltaX)):a.deltaY=e.detail,n(a)},a),this},on:function(t,e,n,a){return t&&e&&n&&(t.addEventListener(e,n,!1),this._buf=this._buf||[],this._buf.push({elem:t,type:e,callback:n,ns:a})),this},off:function(t,e,n,a){return t&&e&&n&&this._buf&&this._buf.forEach(function(i,o){i&&i.type===e&&i.elem===t&&i.callback===n&&i.ns===a&&(t.removeEventListener(e,n,!1),this._buf.slice(o,1))},this),this},offAll:function(t){return this._buf&&(this._buf.forEach(function(e){e&&this.off(e.elem,e.type,e.callback,t||e.ns)},this),t||(this._buf=[])),this}});var w=6,E=0;return s(l.prototype,{template:function(t){var e=this._templates;return e._prepare(b(e[t]()))},_templates:{_prepare:function(t){return t.replace(/\$/g,i+"__")},days:function(){for(var t=[],e=o;r>=e;e++)t.push(this.month(e,this.parent._currentDate.year));return t},weekdays:function(){for(var t=this.parent.text("firstWeekDay")||0,e={first:t,last:t?t-1:w},n=t,a=0;7>a;a++)e[n]=a,n++,n>w&&(n=E);return e},month:function(t,e){var i=new Date(e,t,1,12,0,0,0),o=i.getTime(),r=new Date,s=function(t,e,n){var a=d._val;return t===a.day&&e===a.month&&n===a.year},l=function(t){return t.year?new Date(t.year,t.month,t.day,12,0,0,0).getTime():null},h=function(){var a=function(t){return g(""+t.year+n(t.month))},i=a(b),o=a(D),r=g(""+e+n(t)),s="";return(b&&i>r||D&&r>o)&&(s="$days-title-month_minmax"),{cl:["$days-title-month",s],c:p}};r.setHours(12),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0);for(var c,u,f,d=this.parent,_=i.getDay(),m=this.weekdays(),y=m[_],p=d.text("months")[t],v=[31,a(e)?29:28,31,30,31,30,31,31,30,31,30,31],b=d.setting("min"),D=d.setting("max"),k=l(b),M=l(D),S=r.getTime(),$={t:"tr",c:[_!==m.first?{t:"td",colspan:y,cl:"$empty",c:3>y?"":h()}:""]},x=$,A={cl:"$days-month",c:[3>y?h():"",{t:"table",cl:"$days-table",c:[x]}]},C=1;C<=v[t];C++)c="",i.setDate(C),_=i.getDay(),u=this.parent.getHoliday(C,t,e),f=["$day",_===E||_===w?"$day_holiday":"$day_workday"],0===u?f.push("$day_nonholiday"):1===u&&f.push("$day_highday"),s(C,t,e)&&f.push("$day_selected"),S===o&&(f.push("$day_now"),c=d.text("today")),(k&&k>o||M&&o>M)&&f.push("$day_minmax"),_===m.first&&(x={t:"tr",c:[]},A.c[1].c.push(x)),x.c.push({t:"td",cl:f,title:c,"data-month":t,"data-day":C,c:C});return A},years:function(){for(var t=this.parent._data,e=t._startYear,n=t._endYear,a=[{cl:"$year-selector",c:{cl:"$year-selector-i"}}],i=e;n>=i;i++)a.push({cl:"$year","data-year":i,c:i});return a},months:function(){var t=[{cl:"$month-selector",c:{cl:"$month-selector-i"}}];return this.parent.text("months").forEach(function(e,n){t.push({cl:"$month","data-month":n,c:e})}),t},main:function(){var t=this.parent.text("firstWeekDay")||E,e=[];return this.parent.text("shortWeekDays").forEach(function(n,a,i){e.push({cl:["$short-weekdays-cell","$short-weekdays-cell_n_"+t],title:i[t],c:i[t]}),t++,t>w&&(t=E)},this),[{cl:"$short-weekdays",c:e},{cl:"$container",c:[{cl:"$days",c:{cl:"$days-container",c:this.days()}},{cl:"$months",c:this.months()},{cl:"$years",c:{cl:"$years-container",c:this.years()}}]}]}}}),s(l,{addHolidays:function(t,e){this._holidays=this._holidays||{},this._holidays[t]=e}}),l.prototype.getHoliday=function(t,e,n){var a=this._data.locale,i=l._holidays;return i&&i[a]&&i[a][n]?i[a][n][t+"-"+(e+1)]:void 0},s(l.prototype,{_parseDate:function(t){var e,n,a=null;return t&&("string"==typeof t?(e=/^\s*(\d{4})[-/.](\d\d)(?:[-/.](\d\d))?\s*$/.exec(t),e?n=[e[3],e[2]-1,e[1]]:(e=/^\s*(\d{1,2})[-/.](\d{1,2})(?:[-/.](\d{4}|\d\d))?\s*$/.exec(t),e&&(n=[e[1],e[2]-1,e[3]])),n&&(a=new Date(g(n[2]),g(n[1]),g(n[0])))):"object"==typeof t?t instanceof Date?a=t:t.year&&t.day&&(a=new Date(t.year,t.month-1,t.day,12,0,0,0)):"number"==typeof number&&(a=new Date(t))),a},_parseDateToObj:function(t){var e=this._parseDate(t);return e?{day:e.getDate(),month:e.getMonth(),year:e.getFullYear()}:{}}}),s(l,{_texts:{},_locales:[],addLocale:function(t,e){this._locales.push(t),this._texts[t]=e,e.def&&(this._defaultLocale=t)}}),l.prototype.text=function(t){return l._texts[this._data.locale][t]},l}(this,this.document);Calendula.addLocale("be",{months:["студзень","люты","сакавік","красавік","май","чэрвень","ліпень","жнівень","верасень","кастрычнік","лістапад","снежань"],caseMonths:["студзеня","лютага","сакавіка","красавіка","траўня","траўня","ліпеня","жніўня","верасня","кастрычніка","лістапада","снежня"],shortWeekDays:["Н","П","А","С","Ч","П","С"],today:"Сення",firstWeekDay:1}),Calendula.addLocale("de",{months:["Januar","Februar","Marz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortWeekDays:["So","Mo","Di","Mi","Do","Fr","Sa"],today:"Heute",firstWeekDay:1}),Calendula.addLocale("en",{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortWeekDays:["Su","Mo","Tu","We","Th","Fr","Sa"],today:"Today",firstWeekDay:0,def:!0}),Calendula.addLocale("es",{months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortWeekDays:["Do","Lu","Ma","Mi","Ju","Vi","Sá"],today:"Hoy",firstWeekDay:1}),Calendula.addLocale("fr",{months:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],shortWeekDays:["Di","Lu","Ma","Me","Je","Ve","Sa"],today:"Aujourd’hui",firstWeekDay:1}),Calendula.addLocale("it",{months:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],shortWeekDays:["Do","Lu","Ma","Me","Gi","Ve","Sa"],today:"Oggi",firstWeekDay:1}),Calendula.addLocale("pl",{months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],caseMonths:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","września","października","listopada","grudnia"],shortWeekDays:["N","P","W","Ś","C","P","S"],today:"Dziś",firstWeekDay:1}),Calendula.addLocale("ru",{months:["январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],caseMonths:["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],shortWeekDays:["В","П","В","С","Ч","П","С"],today:"Сегодня",firstWeekDay:1}),Calendula.addLocale("tr",{months:["ocak","şubat","mart","nisan","mayıs","haziran","temmuz","ağustos","eylül","ekim","kasım","aralık"],shortWeekDays:["Pa","PT","Sa","Çarş","Per","CU","Ctesi"],today:"Bugün",firstWeekDay:1}),Calendula.addLocale("uk",{months:["січень","лютий","березень","квітень","травень","червень","липень","серпень","вересень","жовтень","листопад","грудень"],caseMonths:["січня","лютого","березня","квітня","травня","червня","липня","серпня","вересня","жовтня","листопада","грудня"],shortWeekDays:["Н","П","В","С","Ч","П","С"],today:"Сьогодні",firstWeekDay:1});